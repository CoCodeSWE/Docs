# Example YAML to get you started quickly.
# Be aware that YAML has indentation based scoping.
# Code completion support is available so start typing for available options.
swagger: '2.0'

# This is your document metadata
info:
  version: "1.0.0"
  title: Endpoints AtAvi
  description: Accoglienza tramite asistente virtuale
produces:
  - application/json

basePath: /zero12.it
paths:
  /auth/users:
      get:
        description: Get lista utenti
        tags:
          - auth
        responses:
          200:
            description: Invia la lista degli utenti
            schema:
              title: ArrayOfUsers
              type: array
              items:
                 $ref: '#/definitions/User'
          default:
            description: Errore
            schema:
             $ref: '#/definitions/Error'
      post:
        summary: invio dati per la registrazione
        description: invia username, frase per autenticazione tramite SR, e altri dati
        parameters:
            - name: username
              in: body
              description: username dell'utente
              required: true
              type: string

            - name: frase
              in: body
              description: frase usata per l'autenticazione tramite SR
              required: true
              type: string

            - name: altro
              in: body
              description: altri dati, da completare
              required: false
              type: string
         tags:
            - auth
         responses:
            200:
              description: Restituisce id dell'utente appena creato
              schema:
                title: IdUser
                type: string
            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'

  /auth/users/:username:
      put:
        summary: modifica dati utente
        description: vengono inviati i nuovi dati dell'utente per sovrascrivere i dati vecchi
        parameters:
            - name: newUser
              in: path
              description: nuovi dati User per sovrascrittura
              required: true
              schema:
                $ref: '#/definitions/User'
        tags:
            - auth
        responses:
          201:
              description: stringa di modifica avvenuta con successo
              schema:
                title: ModificaAvvenuta
                type: string
            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'
      delete:
          summary: elimina utente
          description: vengono eliminati i dati di un utente
          parameters:
            - name: idDel
              in: path
              description: contiene id dell'utente da eliminare
              required: true
              type: string

          responses:
            204:
              description: no content
            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'
      get:
          description: riceve dati relativi all'utente
          parameters:
            - name: idGet
              in: path
              description: contiene id dell'utente di cui si vogliono i dati
              required: true
              type: string
          responses:
            200:
              description: dati dell'utente richiesto
              schema:
                '#/definitions/User'

            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'

    /auth/web/username:
      post:
         summary: autenticazione tramite login
         description: vengono inviati i dati necessari al login, ovvero username,...
         parameters:
            - name: UsernameLogin
              in: body
              description: contiene l'username dell'utente che si vuole autenticare
              required: true
              type: string
         responses:
            200:
              description: viene inviato un token di sessione all'utente
              schema:
                title: TokenLogin
                type: string

            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'
    /auth/vocal/username:
      post:
          summary: autenticazione per via vocale
          description: vengono inviati i dati per il login per via vocale, ovvero username, file audio,...
          parameters:
               - name: UsernameVocal
                 in: body
                 description: contiene l'username dell'utente che si vuole autenticare
                 required: true
                 type: string
               - name: AudioLogin
                 in: path
                 description: contiene il blob audio per l'autenticazione per via vocale
                 required: true
                 type: binary
          responses:
              200:
                description: viene inviato un token di sessione all'utente
                schema:
                  title: TokenVocalLogin
                  type: string

              default:
                description: Errore
                schema:
                  $ref: '#/definitions/Error'

    /auth/vocal/:username/enrollments:
       post:
         summary: aggiunta enrollments della frase scelta
         description: vengono aggiunti enrollments, ovvero file audio della frase scelta nel corpo audio dell'utente
         parameters:
           - name: IdEnrollment
             in: path
             description: contiene l'id dell'utente che vuole aggiungere un enrollment
             required: true
             type: string
           - name: AudioEnrollment
             in: body
             description: contiene il blob audio dell'enrollments
             required: true
             type: binary

         responses:
          200:
            description: risposta di avvenuta ricezione
            schema:
              title: AggiuntoEnrollment
              type: string

          default:
            description: Errore
            schema:
              $ref: '#/definitions/Error'

       delete:
        description: eliminazione di tutti gli enrollments di un utente
        parameters:
          - name: IdDelEnroll
            in: path
            description: contiene l'id dell'utente che vuole eliminare tutti i suoi enrollments
            required: true
            type: string

        responses:
          204:
            description: no content

          default:
            description: Errore
            schema:
              $ref: '#/definitions/Error'


/av:
      post:
          summary: interrogazione assistente virtuale
          description: viene inviato un file audio contenente l'interrogazione all'assistente virtuale
          parameters:
            - name: AudioAv
              in: body
              description: contiene il blob audio dell'interrogazione
              required: true
              type: binary

          responses:
            200:
              description: risposta av
              schema:
                title: risposta dell'assistente virtuale
                type: string

              default:
                description: Errore
                schema:
                  $ref: '#/definitions/Error'

 /webhook:
        post:
          description: utilizzo webhook
          parameters:
            - name: webhook
              in: body
              description: contiene il webhook
              required: true
              schema:
                $ref: '#/definitions/webhook'

          responses:
            200:
              description: risposta webhook avvenuto
              schema:
                title: risposta
                type: string

            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'


    /impostazioni:
       get:
         description: get lista direttive

         responses:
           description: invia lista direttive
           schema:
            title: ArrayOfDirettive
            type: array
            items:
              $ref: '#/definitions/direttiva'

       post:
        description: creazione nuova direttiva
        parameters:
          - name: newDirettiva
            in: body
            description: contiene la nuova direttiva
            required: true
            schema:
              $ref: '#/definitions/direttiva'

        responses:
          200:
            description: risposta direttiva creata
            schema:
              title: DirettivaCreata
              type: string

          default:
            description: Errore
            schema:
              $ref: '#/definitions/Error'

  /impostazioni/:id:
      put:
        summary: modifica impostazioni direttiva
        description: vengono inviati nuove impostazioni direttiva per sovrascrivere le vecchie
        parameters:
            - name: IdImp
              in: path
              description: nuove impostazioni per sovrascrittura
              required: true
              schema:
                $ref: '#/definitions/direttiva'
        responses:
          201:
              description: stringa di modifica avvenuta con successo
              schema:
                title: ModificaImpAvvenuta
                type: string
            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'

        get:
          description: get direttiva che corrisponde a id
          parameters:
            - name: IdDir
              in: path
              description: id direttiva
              required: true
              type: string

          responses:
            200:
              description: direttiva corrispondente a id
              schema:
                $ref: '#/definitions/direttiva'

            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'

        delete:
          description: delete direttiva che corrisponde a id
          parameters:
            - name: IdDir
              in: path
              description: id direttiva
              required: true
              type: string

          responses:
            204:
              description: no content

            default:
              description: Errore
              schema:
                $ref: '#/definitions/Error'

  /impostazioni/functions/:
                  

    definitions:
      User:
        type: object
        properties:
          username:
            type: string
          name:
            type: string
          surname:
            type: string
          id:
            type: string
          altro:
            type: string

      Error:
        type: object
        properties:
          code:
            type: integer
            format: int32
          message:
            type: string
          fields:
            type: string

      webhook:
        type: object
        properties:
          name:
            type: string

      direttiva:
        type: object
        properties:
          name:
            type: string
          id:
            type: string
